import{S as wt,i as At,s as It,Y as at,k as d,q as k,a as b,l as f,m as p,r as y,h as c,c as v,n as o,b as Z,C as n,Z as j,K as H,_ as lt,a6 as we,g as Ae,d as Ie,R as Vt,$ as Pt,F as nt,u as _e,D as _,w as pt,a0 as mt,y as gt,z as bt,A as vt,a1 as _t,B as ht}from"./index.78e4d4d0.js";import{a as Ee,A as rt}from"./apiFetch.0eddb5fd.js";import{g as st}from"./navigation.55c11801.js";import{f as kt,c as Ge,a as X,b as $t,g as Dt,d as it,e as St}from"./index.esm.4d95b399.js";import{c as yt,S as Et}from"./Select.8a162bf7.js";import{p as Tt}from"./parseOptionToId.62dacb35.js";import{a as Lt,b as Ct}from"./config.c4e28fd4.js";import{t as Me}from"./ProgressBar.svelte_svelte_type_style_lang.3c02a640.js";const Nt=kt().transform((e,t)=>typeof t=="object"?void 0:parseFloat(e)).transform(e=>e<=0?void 0:e).nullable(),Ot=Ge().shape({_id:kt().optional(),name:X().min(2,"Deve possuir no mínimo 2 caracteres").required("Campo obrigatório"),tags:$t(Ge().shape({label:X().required(),value:X().required()})).optional(),email:X().email().optional(),company:Ge().shape({label:X().required(),value:X().required()}).nullable(),target:X().optional(),landArea:Nt.optional(),vgv:Dt().min(0,"Número deve ser positivo").nullable().optional(),lastUpdated:it().optional().nullable(),createdAt:it().optional()});function ot(e){let t,s=e[1].name+"",l;return{c(){t=d("div"),l=k(s),this.h()},l(r){t=f(r,"DIV",{class:!0});var a=p(t);l=y(a,s),a.forEach(c),this.h()},h(){o(t,"class","text-red-500 text-xs")},m(r,a){Z(r,t,a),n(t,l)},p(r,a){a&2&&s!==(s=r[1].name+"")&&_e(l,s)},d(r){r&&c(t)}}}function ct(e){let t,s=e[1].email+"",l;return{c(){t=d("div"),l=k(s),this.h()},l(r){t=f(r,"DIV",{class:!0});var a=p(t);l=y(a,s),a.forEach(c),this.h()},h(){o(t,"class","text-red-500 text-xs")},m(r,a){Z(r,t,a),n(t,l)},p(r,a){a&2&&s!==(s=r[1].email+"")&&_e(l,s)},d(r){r&&c(t)}}}function ut(e){let t,s=e[1].target+"",l;return{c(){t=d("div"),l=k(s),this.h()},l(r){t=f(r,"DIV",{class:!0});var a=p(t);l=y(a,s),a.forEach(c),this.h()},h(){o(t,"class","text-red-500 text-xs")},m(r,a){Z(r,t,a),n(t,l)},p(r,a){a&2&&s!==(s=r[1].target+"")&&_e(l,s)},d(r){r&&c(t)}}}function qt(e){return{c:_,l:_,m:_,p:_,i:_,o:_,d:_}}function Bt(e){let t,s,l;function r(i){e[12](i)}let a={items:e[21],multiple:!0,filter:yt};return e[0].tags!==void 0&&(a.value=e[0].tags),t=new Et({props:a}),pt.push(()=>mt(t,"value",r)),{c(){gt(t.$$.fragment)},l(i){bt(t.$$.fragment,i)},m(i,g){vt(t,i,g),l=!0},p(i,g){const $={};!s&&g&1&&(s=!0,$.value=i[0].tags,_t(()=>s=!1)),t.$set($)},i(i){l||(Ae(t.$$.fragment,i),l=!0)},o(i){Ie(t.$$.fragment,i),l=!1},d(i){ht(t,i)}}}function Rt(e){let t,s;return{c(){t=d("p"),s=k("Loading tag options...")},l(l){t=f(l,"P",{});var r=p(t);s=y(r,"Loading tag options..."),r.forEach(c)},m(l,r){Z(l,t,r),n(t,s)},p:_,i:_,o:_,d(l){l&&c(t)}}}function Ut(e){return{c:_,l:_,m:_,p:_,i:_,o:_,d:_}}function Ft(e){let t,s,l;function r(i){e[13](i)}let a={items:e[20],filter:yt};return e[0].company!==void 0&&(a.value=e[0].company),t=new Et({props:a}),pt.push(()=>mt(t,"value",r)),{c(){gt(t.$$.fragment)},l(i){bt(t.$$.fragment,i)},m(i,g){vt(t,i,g),l=!0},p(i,g){const $={};!s&&g&1&&(s=!0,$.value=i[0].company,_t(()=>s=!1)),t.$set($)},i(i){l||(Ae(t.$$.fragment,i),l=!0)},o(i){Ie(t.$$.fragment,i),l=!1},d(i){ht(t,i)}}}function Ht(e){let t,s;return{c(){t=d("p"),s=k("Loading companies...")},l(l){t=f(l,"P",{});var r=p(t);s=y(r,"Loading companies..."),r.forEach(c)},m(l,r){Z(l,t,r),n(t,s)},p:_,i:_,o:_,d(l){l&&c(t)}}}function dt(e){let t,s=e[1].vgv+"",l;return{c(){t=d("div"),l=k(s),this.h()},l(r){t=f(r,"DIV",{class:!0});var a=p(t);l=y(a,s),a.forEach(c),this.h()},h(){o(t,"class","text-red-500 text-xs")},m(r,a){Z(r,t,a),n(t,l)},p(r,a){a&2&&s!==(s=r[1].vgv+"")&&_e(l,s)},d(r){r&&c(t)}}}function ft(e){let t,s=e[1].landArea+"",l;return{c(){t=d("div"),l=k(s),this.h()},l(r){t=f(r,"DIV",{class:!0});var a=p(t);l=y(a,s),a.forEach(c),this.h()},h(){o(t,"class","text-red-500 text-xs")},m(r,a){Z(r,t,a),n(t,l)},p(r,a){a&2&&s!==(s=r[1].landArea+"")&&_e(l,s)},d(r){r&&c(t)}}}function jt(e){let t,s,l,r,a,i,g,$,ue,de,D,S,x,T,z,fe,pe,L,me,ge,C,G,ee,te,u,be,ae,R,E,ve,Ve,K,Pe,$e,he,De,le,Se,Te,U,J,Le,Ce,q,Ne,Oe,F,Q,qe,Be,B,Re,Ue,ne,W,Fe,ke,He,Ke,w=e[1].name&&ot(e),A=e[1].email&&ct(e),I=e[1].target&&ut(e),N={ctx:e,current:null,token:null,hasCatch:!1,pending:Rt,then:Bt,catch:qt,value:21,blocks:[,,,]};at(e[2],N);let O={ctx:e,current:null,token:null,hasCatch:!1,pending:Ht,then:Ft,catch:Ut,value:20,blocks:[,,,]};at(e[3],O);let V=e[1].vgv&&dt(e),P=e[1].vgv&&ft(e);return{c(){t=d("div"),s=d("div"),l=d("h2"),r=k("Criar/Editar Pessoa"),a=b(),i=d("form"),g=d("div"),$=d("label"),ue=k("Nome"),de=b(),D=d("input"),S=b(),w&&w.c(),x=b(),T=d("div"),z=d("label"),fe=k("Email"),pe=b(),L=d("input"),me=b(),A&&A.c(),ge=b(),C=d("div"),G=d("label"),ee=k("Target"),te=b(),u=d("input"),be=b(),I&&I.c(),ae=b(),R=d("div"),E=d("p"),ve=k(`Tags
					`),N.block.c(),Ve=b(),K=d("p"),Pe=k(`Companies
					`),O.block.c(),$e=b(),he=d("hr"),De=b(),le=d("h5"),Se=k("Real State"),Te=b(),U=d("div"),J=d("label"),Le=k("VGV"),Ce=b(),q=d("input"),Ne=b(),V&&V.c(),Oe=b(),F=d("div"),Q=d("label"),qe=k("Área do Terreno"),Be=b(),B=d("input"),Re=b(),P&&P.c(),Ue=b(),ne=d("div"),W=d("button"),Fe=k("Salvar"),this.h()},l(M){t=f(M,"DIV",{class:!0});var m=p(t);s=f(m,"DIV",{class:!0});var Y=p(s);l=f(Y,"H2",{class:!0});var Ye=p(l);r=y(Ye,"Criar/Editar Pessoa"),Ye.forEach(c),a=v(Y),i=f(Y,"FORM",{});var h=p(i);g=f(h,"DIV",{class:!0});var re=p(g);$=f(re,"LABEL",{class:!0,for:!0});var Ze=p($);ue=y(Ze,"Nome"),Ze.forEach(c),de=v(re),D=f(re,"INPUT",{class:!0,type:!0,id:!0}),S=v(re),w&&w.l(re),re.forEach(c),x=v(h),T=f(h,"DIV",{class:!0});var se=p(T);z=f(se,"LABEL",{class:!0,for:!0});var Je=p(z);fe=y(Je,"Email"),Je.forEach(c),pe=v(se),L=f(se,"INPUT",{class:!0,type:!0,id:!0}),me=v(se),A&&A.l(se),se.forEach(c),ge=v(h),C=f(h,"DIV",{class:!0});var ie=p(C);G=f(ie,"LABEL",{class:!0,for:!0});var Qe=p(G);ee=y(Qe,"Target"),Qe.forEach(c),te=v(ie),u=f(ie,"INPUT",{class:!0,type:!0,id:!0}),be=v(ie),I&&I.l(ie),ie.forEach(c),ae=v(h),R=f(h,"DIV",{class:!0});var ye=p(R);E=f(ye,"P",{class:!0});var je=p(E);ve=y(je,`Tags
					`),N.block.l(je),je.forEach(c),Ve=v(ye),K=f(ye,"P",{class:!0});var ze=p(K);Pe=y(ze,`Companies
					`),O.block.l(ze),ze.forEach(c),ye.forEach(c),$e=v(h),he=f(h,"HR",{class:!0}),De=v(h),le=f(h,"H5",{class:!0});var We=p(le);Se=y(We,"Real State"),We.forEach(c),Te=v(h),U=f(h,"DIV",{class:!0});var oe=p(U);J=f(oe,"LABEL",{class:!0,for:!0});var Xe=p(J);Le=y(Xe,"VGV"),Xe.forEach(c),Ce=v(oe),q=f(oe,"INPUT",{class:!0,type:!0,id:!0,min:!0}),Ne=v(oe),V&&V.l(oe),oe.forEach(c),Oe=v(h),F=f(h,"DIV",{class:!0});var ce=p(F);Q=f(ce,"LABEL",{class:!0,for:!0});var xe=p(Q);qe=y(xe,"Área do Terreno"),xe.forEach(c),Be=v(ce),B=f(ce,"INPUT",{class:!0,type:!0,id:!0,min:!0}),Re=v(ce),P&&P.l(ce),ce.forEach(c),Ue=v(h),ne=f(h,"DIV",{class:!0});var et=p(ne);W=f(et,"BUTTON",{type:!0,class:!0});var tt=p(W);Fe=y(tt,"Salvar"),tt.forEach(c),et.forEach(c),h.forEach(c),Y.forEach(c),m.forEach(c),this.h()},h(){o(l,"class","text-lg font-medium text-gray-900 mb-2"),o($,"class","block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"),o($,"for","name"),o(D,"class","appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white"),o(D,"type","text"),o(D,"id","name"),o(g,"class","mb-4"),o(z,"class","block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"),o(z,"for","email"),o(L,"class","appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white"),o(L,"type","email"),o(L,"id","email"),o(T,"class","mb-4"),o(G,"class","block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"),o(G,"for","email"),o(u,"class","appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white"),o(u,"type","text"),o(u,"id","target"),o(C,"class","mb-4"),o(E,"class","block uppercase tracking-wide text-gray-700 text-xs font-bold mb-3"),o(K,"class","block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"),o(R,"class","mb-4"),o(he,"class","border-t-2"),o(le,"class","my-4"),o(J,"class","block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"),o(J,"for","email"),o(q,"class","appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white"),o(q,"type","number"),o(q,"id","vgv"),o(q,"min","0"),o(U,"class","mb-4"),o(Q,"class","block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"),o(Q,"for","email"),o(B,"class","appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white"),o(B,"type","number"),o(B,"id","landArea"),o(B,"min","0"),o(F,"class","mb-4"),o(W,"type","submit"),o(W,"class","text-blue-500 font-bold"),o(ne,"class","flex justify-end"),o(s,"class","p-4"),o(t,"class","bg-white rounded-lg overflow-hidden shadow-lg")},m(M,m){Z(M,t,m),n(t,s),n(s,l),n(l,r),n(s,a),n(s,i),n(i,g),n(g,$),n($,ue),n(g,de),n(g,D),j(D,e[0].name),n(g,S),w&&w.m(g,null),n(i,x),n(i,T),n(T,z),n(z,fe),n(T,pe),n(T,L),j(L,e[0].email),n(T,me),A&&A.m(T,null),n(i,ge),n(i,C),n(C,G),n(G,ee),n(C,te),n(C,u),j(u,e[0].target),n(C,be),I&&I.m(C,null),n(i,ae),n(i,R),n(R,E),n(E,ve),N.block.m(E,N.anchor=null),N.mount=()=>E,N.anchor=null,n(R,Ve),n(R,K),n(K,Pe),O.block.m(K,O.anchor=null),O.mount=()=>K,O.anchor=null,n(i,$e),n(i,he),n(i,De),n(i,le),n(le,Se),n(i,Te),n(i,U),n(U,J),n(J,Le),n(U,Ce),n(U,q),j(q,e[0].vgv),n(U,Ne),V&&V.m(U,null),n(i,Oe),n(i,F),n(F,Q),n(Q,qe),n(F,Be),n(F,B),j(B,e[0].landArea),n(F,Re),P&&P.m(F,null),n(i,Ue),n(i,ne),n(ne,W),n(W,Fe),ke=!0,He||(Ke=[H(D,"input",e[6]),H(D,"input",e[9]),H(L,"input",e[6]),H(L,"input",e[10]),H(u,"input",e[6]),H(u,"input",e[11]),H(q,"input",e[6]),H(q,"input",e[14]),H(B,"input",e[6]),H(B,"input",e[15]),H(i,"submit",e[7])],He=!0)},p(M,[m]){e=M,m&1&&D.value!==e[0].name&&j(D,e[0].name),e[1].name?w?w.p(e,m):(w=ot(e),w.c(),w.m(g,null)):w&&(w.d(1),w=null),m&1&&L.value!==e[0].email&&j(L,e[0].email),e[1].email?A?A.p(e,m):(A=ct(e),A.c(),A.m(T,null)):A&&(A.d(1),A=null),m&1&&u.value!==e[0].target&&j(u,e[0].target),e[1].target?I?I.p(e,m):(I=ut(e),I.c(),I.m(C,null)):I&&(I.d(1),I=null),lt(N,e,m),lt(O,e,m),m&1&&we(q.value)!==e[0].vgv&&j(q,e[0].vgv),e[1].vgv?V?V.p(e,m):(V=dt(e),V.c(),V.m(U,null)):V&&(V.d(1),V=null),m&1&&we(B.value)!==e[0].landArea&&j(B,e[0].landArea),e[1].vgv?P?P.p(e,m):(P=ft(e),P.c(),P.m(F,null)):P&&(P.d(1),P=null)},i(M){ke||(Ae(N.block),Ae(O.block),ke=!0)},o(M){for(let m=0;m<3;m+=1){const Y=N.blocks[m];Ie(Y)}for(let m=0;m<3;m+=1){const Y=O.blocks[m];Ie(Y)}ke=!1},d(M){M&&c(t),w&&w.d(),A&&A.d(),I&&I.d(),N.block.d(),N.token=null,N=null,O.block.d(),O.token=null,O=null,V&&V.d(),P&&P.d(),He=!1,Vt(Ke)}}}function zt(e,t,s){var ee,te;let l,r,{person:a=void 0}=t;const i=Pt();async function g(){const{data:u}=await Ee.get(rt.tags.getAllForSelect);return u}async function $(){const{data:u}=await Ee.get(rt.company.getAllForSelect);return u}let ue=g(),de=$(),D={name:(a==null?void 0:a.name)??"",email:(a==null?void 0:a.email)??"",target:(a==null?void 0:a.target)??"",tags:(a==null?void 0:a.tags)??[],vgv:a==null?void 0:a.vgv,landArea:a==null?void 0:a.landArea,company:a?{value:((ee=a==null?void 0:a.company)==null?void 0:ee._id)??"",label:((te=a==null?void 0:a.company)==null?void 0:te.name)??""}:void 0};const{form:S,errors:x,handleChange:T,handleSubmit:z}=St({initialValues:D,validationSchema:Ot,onSubmit:async u=>{var R;const be=Tt(u==null?void 0:u.tags),ae={...u,tags:be,company:(R=u.company)==null?void 0:R.value};try{a?await Ee.put("person/"+(a==null?void 0:a._id),ae).then(E=>{i("personUpdated",E.data),Me.trigger(Lt),st("/person/"+(a==null?void 0:a._id))}):await Ee.post("person",ae).then(E=>{console.log("response>>",E),Me.trigger(Ct),st("/person/"+E.data._id)})}catch(E){const{clientMessage:ve}=E.response.data.error;Me.trigger({message:ve||"Ocorreu um erro",background:"variant-filled-error"}),console.error(E)}finally{}}});nt(e,S,u=>s(0,l=u)),nt(e,x,u=>s(1,r=u));function fe(){l.name=this.value,S.set(l)}function pe(){l.email=this.value,S.set(l)}function L(){l.target=this.value,S.set(l)}function me(u){e.$$.not_equal(l.tags,u)&&(l.tags=u,S.set(l))}function ge(u){e.$$.not_equal(l.company,u)&&(l.company=u,S.set(l))}function C(){l.vgv=we(this.value),S.set(l)}function G(){l.landArea=we(this.value),S.set(l)}return e.$$set=u=>{"person"in u&&s(8,a=u.person)},[l,r,ue,de,S,x,T,z,a,fe,pe,L,me,ge,C,G]}class Xt extends wt{constructor(t){super(),At(this,t,zt,jt,It,{person:8})}}export{Xt as P};
